// Generated by CoffeeScript 1.7.1
(function() {
  var make_year, months;

  this.database = {};

  MONTH_NAMES = {
    1: ["Jan", "January"],
    2: ["Jan", "Febuary"],
    3: ["Jan", "March"],
    4: ["Jan", "April"],
    5: ["Jan", "May"],
    6: ["Jan", "June"],
    7: ["Jan", "July"],
    8: ["Jan", "August"],
    9: ["Jan", "September"],
    10: ["Jan", "October"],
    11: ["Jan", "November"],
    12: ["Jan", "December"]
  };

  make_year = function(year, months) {
    var after, before, e, elm, m, timeline, yr, yrid, _i, _j, _len, _ref, _results;
    year = parseInt(year);
    timeline = $("#timeline");
    before = elm = after = 0;
    yrid = "y" + year;
    _ref = timeline.children("[id^='y']");
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      e = _ref[_i];
      if (e.id == null) {
        continue;
      }
      if (e.id === yrid) {
        elm = $(e);
        break;
      } else {
        yr = parseInt(e.id.slice(1));
        if (year < yr) {
          before = e;
          break;
        } else if (year > yr) {
          after = e;
        }
      }
    }
    if (!elm) {
      elm = $("<div></div>");
      elm.attr("id", "y" + year);
      if (before) {
        $(before).before(elm);
      } else {
        $(after).after(elm);
      }
    }
    elm.empty();
    _results = [];
    for (m = _j = 1; _j <= 12; m = ++_j) {
      e = $("<div></div>");
      elm.append($("<div class='month-heading'>" + MONTH_NAMES[m][1] + " " + year + "</div>"));
      e.attr("id", "y" + year + "m" + m);
      _results.push(elm.append(e));
    }
    return _results;
  };

  $(function() {
    var trove, yr, _i, _results;
    trove = new Trove();
    $.extend(trove.defaults, {
      q: town,
      include: "articletext,links,years",
      zone: "picture,newspaper,map,article"
    });
    _results = [];
    for (yr = _i = 1900; _i <= 2000; yr = ++_i) {
      _results.push(make_year(yr));
    }
    return _results;
  });

}).call(this);
